
VI1<- lmer(subsad$SDS_BMI~ subsad$ageattest*subsad$Gender + subsad$Ethnicity*subsad$PostcodeDecile+subsad$IsAccountRegistered+(1|subsad$ChildID)+(1|subsad$SchoolCode),REML=FALSE)
summary(VI1)
#model converges
VI1b<- lmer(subsad$SDS_BMI~ subsad$ageattest*subsad$Gender + subsad$Ethnicity+subsad$PostcodeDecile+subsad$IsAccountRegistered+(1|subsad$ChildID)+(1|subsad$SchoolCode),REML=FALSE)
anova(VI1,VI1b,test="LRT")
#The interaction between ethnicity and postcode decile is important

VI2<- lmer(subsad$SDS_BMI~ subsad$ageattest+subsad$Gender + subsad$Ethnicity*subsad$PostcodeDecile+subsad$IsAccountRegistered+(1|subsad$ChildID)+(1|subsad$SchoolCode),REML=FALSE)
anova(VI1,VI2,test="LRT")
#The interaction between age and gender is important

VI3<- lmer(subsad$SDS_BMI~ subsad$ageattest*subsad$Gender + subsad$Ethnicity*subsad$PostcodeDecile+(1|subsad$ChildID)+(1|subsad$SchoolCode),REML=FALSE)
anova(VI1,VI3,test="LRT")
#IsAccountRegistered is not a significant predictor in this dataset 
#probably because it depends on the point of registration

VI4<- lmer(subsad$SDS_BMI~ subsad$ageattest*subsad$Gender + subsad$Ethnicity*subsad$PostcodeDecile+(1|subsad$ChildID),REML=TRUE)
anova(VI3,VI4,test="LRT")
#School is important as a random effect

VI5<- lmer(subsad$SDS_BMI~ subsad$ageattest*subsad$Gender + subsad$Ethnicity*subsad$PostcodeDecile+(1|subsad$SchoolCode),REML=FALSE)
anova(VI3,VI5,test="LRT")
#ChildID is a significant predictor as a random effect

#VI3 gives the best fit. ChildID improves fit (based on AIC), as do the interactions between age and gender, and ethnicity and postcode decile.

Ethnicity2<-subsad$Ethnicity
levels(Ethnicity2)
levels(Ethnicity2)[1:2]<-"Other"
levels(Ethnicity2)[17:18]<-"Other"
VI6<- lmer(subsad$SDS_BMI~ subsad$ageattest*subsad$Gender + Ethnicity2*subsad$PostcodeDecile +(1|subsad$ChildID)+(1|subsad$School),REML=FALSE)
anova(VI3, VI6,test="LRT")
#count unknown ethnicity as part of other

Ethnicity3<-Ethnicity2
levels(Ethnicity3)[5:6]<-"Mixed black/white"
VI7<- lmer(subsad$SDS_BMI~ subsad$ageattest*subsad$Gender + Ethnicity3*subsad$PostcodeDecile +(1|subsad$ChildID)+(1|subsad$School),REML=FALSE)
anova(VI6, VI7,test="LRT")
#mixed black african and mixed black caribbean can be grouped

Ethnicity4<-Ethnicity3
levels(Ethnicity4)[7]<-"Other"
VI8<- lmer(subsad$SDS_BMI~ subsad$ageattest*subsad$Gender + Ethnicity4*subsad$PostcodeDecile +(1|subsad$ChildID)+(1|subsad$School),REML=FALSE)
anova(VI7, VI8,test="LRT")
#'any other mixed background' can be grouped with other

Ethnicity5<-Ethnicity4
levels(Ethnicity5)
levels(Ethnicity5)[2:4]<-"White"
VI9<- lmer(subsad$SDS_BMI~ subsad$ageattest*subsad$Gender + Ethnicity5*subsad$PostcodeDecile +(1|subsad$ChildID)+(1|subsad$School),REML=FALSE)
anova(VI8, VI9,test="LRT")
Ethnicity5<-Ethnicity4
levels(Ethnicity5)[2:3]<-"White"
VI9<- lmer(subsad$SDS_BMI~ subsad$ageattest*subsad$Gender + Ethnicity5*subsad$PostcodeDecile +(1|subsad$ChildID)+(1|subsad$School),REML=FALSE)
anova(VI8, VI9,TEST="LRT")
#British and Irish can be grouped but not with other white

Ethnicity6<-Ethnicity5
levels(Ethnicity6)
levels(Ethnicity6)[3]<-"White other"
levels(Ethnicity6)[6]<-"Ind
